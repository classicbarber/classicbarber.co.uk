name: Eleventy Build and Deploy
on: [push]

jobs:
  build_deploy:
    runs-on: ubuntu-18.04
    steps:
      - uses: actions/checkout@master
      - name: Build
        uses: TartanLlama/actions-eleventy@v1.1
        with:
          args: --output dist
          install_dependencies: true

      - name: Deploy
        uses: SamKirkland/FTP-Deploy-Action@4.2.0
        with:
          server: ${{ secrets.FTP_CONNECTION }}
          username: ${{ secrets.FTP_USERNAME }}
          password: ${{ secrets.FTP_PASSWORD }}
          local-dir: ./dist/
          server-dir: ./public_html/
          log-level: verbose
          dry-run: false
          exclude: '
            - .git*
            - **/.git*
            - **/.git*/**
            - **/node_modules/**
            - **/.env
            - **/box.json
            - **/server.json
            - **/tests/**
            - **/testbox/**
            - **/resources/**
            - **/_assets/**
            - **/WEB-INF/**
            '
